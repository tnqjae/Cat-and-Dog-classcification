<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê°•ì•„ì§€ ğŸ¶ vs ê³ ì–‘ì´ ğŸ± ë¶„ë¥˜ê¸°</title>
  <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© CSS -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
        integrity="sha384-+YQ4/0rZl0vNPclz9ZCE3D5veuT5M/tHRE7fWd5R3Y1gKsCTbGU5ZaFuk1pP2xgq"
        crossorigin="anonymous">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin-top: 50px;
      text-align: center;
    }
    .preview-container {
      max-width: 400px;
      margin: 20px auto 0; /* ê°€ìš´ë° ì •ë ¬ & ìœ„ìª½ ì—¬ë°± */
    }
    #image-preview {
      display: none;
      width: 100%;
      height: auto;
      margin: 0 auto;
      border-radius: 4px;
      border: 1px solid #dee2e6;
    }
    .card {
      margin-top: 20px;
      text-align: center;
      padding: 15px;
      border: 1px solid #dee2e6;
      border-radius: 4px;
    }
    .btn-upload {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 class="mb-4">ê°•ì•„ì§€ ğŸ¶ vs ê³ ì–‘ì´ ğŸ± ë¶„ë¥˜ê¸°</h2>
    
    <!-- ì—…ë¡œë“œ í¼ (ë¶€íŠ¸ìŠ¤íŠ¸ë© í¼ ê·¸ë£¹) -->
    <form id="upload-form" class="form-inline d-flex justify-content-center">
      <div class="form-group mb-2">
        <input type="file" id="image-input" accept="image/*" class="form-control-file">
      </div>
      <button type="submit" class="btn btn-primary ml-2 mb-2 btn-upload">ì˜ˆì¸¡í•˜ê¸°</button>
    </form>

    <!-- ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì¹´ë“œ ì˜ì—­ -->
    <div class="preview-container">
      <div id="preview-card" class="card" style="display: none;">
        <img id="image-preview" src="" alt="Uploaded Image">
      </div>
    </div>
  </div>

  <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© JS (ì˜ì¡´ì„±: jQuery, Popper.js) -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
          integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
          crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc5Sd5VoX1z1rZ75fHP8+8Ac1C8tcsC2fAP6IMR9D"
          crossorigin="anonymous"></script>

  <script>
    document.getElementById("upload-form").addEventListener("submit", function(event) {
      event.preventDefault(); // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ë°©ì§€

      const input = document.getElementById("image-input");
      if (!input.files || !input.files.length) {
        alert("ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”!");
        return;
      }

      const file = input.files[0];
      const formData = new FormData();
      formData.append("image", file);

      // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì„¤ì •
      const reader = new FileReader();
      reader.onload = function(e) {
        const imgPreview = document.getElementById("image-preview");
        imgPreview.src = e.target.result;
        document.getElementById("preview-card").style.display = "block";
        imgPreview.style.display = "block"; // ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
      };
      reader.readAsDataURL(file);

      // Flask ì„œë²„ë¡œ ì´ë¯¸ì§€ ì—…ë¡œë“œ ìš”ì²­
      fetch("http://127.0.0.1:5555/predict", {
        method: "POST",
        body: formData
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        console.log("ì„œë²„ ì‘ë‹µ:", data);
        // ê²°ê³¼ë¥¼ alertë¡œ ë„ì›€
        alert(`Prediction: ${data.prediction}\nProbability: ${(data.probability * 100).toFixed(2)}%`);
      })
      .catch(error => {
        console.error("ì˜ˆì¸¡ ì˜¤ë¥˜:", error);
        alert("ì˜ˆì¸¡ ì‹¤íŒ¨!");
      });
    });
  </script>
</body>
</html>
